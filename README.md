# llm_rag_hw
Project for second homework in LLM course 24f

Model Retrieval Service

# Задание
Поднять RAG-pipeline с выбранной бесплатной моделью (на основе vllm, ollama, Mistral через бесплатный API), где в качестве базы знаний используется учебник/конспекты лекций по какой-то из дисциплин (втекстовом виде, не pdf/djvu/сканы!) 

Можете обратиться к затеханным лекциям по дисциплинам. Сдача через загрузку своего решения на github (не забудьте убрать токены, если будете использовать API). Дедлайн – ~20 января

# Введение
Это типовой поисковый сервис, который использует API Mistral AI для поиска релевантных фрагментов текста на основе заданного вопроса.

Модель уже дообучена на учебной книге `A MATHEMATICIAN'S APOLOGY` `BY G. H.HARDY`

# Структура проекта
- `embeddings` - папка с весами обученной модели
- `constants.py` - основной файл с константами, в нег же записывается `API_KEY` от Mistral
- `main.py` - основная логика программы
- `mistral_service.py` - содержит функцию запуска `run_mistral`
- `question.txt` - файл, в который кладется текст вопроса
- `textbook.txt` - файл с текстом учебника
- `utils.py` - файл с полезными утилитами для работы программы
- `requirements.txt` - файл с используемыми библиотеками

# Запуск модели
1. Установить пакеты - `pip install -r requirements.txt`.
2. В файл `question.txt` записать вопрос, на который модель будет отвечать.
3. Запустить основной скрипт `python main.py`.
4. В скрипте есть 2 режима работы - генерация ембеддингов текста книги и генерация ответа на вопрос
5. В режимах требуется ввести адрес до файлов с текстом книги и вопросом(или оставить по умолчанию)

**ВАЖНО**: Заполните `YOUR_API_KEY` в `constants.py` корректным Mistral API key.